# 双向翻译功能说明

## 功能概述

扩展现在支持**智能双向翻译**:
- 📝 选择**中文**文本 → 自动翻译成**英文**
- 📝 选择**英文**文本 → 自动翻译成**中文**

AI会自动检测输入语言并翻译成对应的目标语言,无需手动切换。

## 工作原理

### AI翻译(推荐)
使用AI模型(GPT/Claude等)时,系统会通过智能提示词自动识别语言:

**默认系统提示词:**
```
你是一个专业的双向翻译助手。请根据用户输入的语言自动判断并翻译:
- 如果输入是中文,则翻译成英文
- 如果输入是英文,则翻译成中文
只返回翻译结果,不要添加任何解释或额外内容。
```

### Google翻译
Google翻译引擎目前仍然是单向翻译(英文→中文)。如需双向翻译,请使用AI翻译引擎。

## 使用示例

### 示例1: 英文 → 中文
**选择文本:**
```
Hello, how are you?
```

**翻译结果:**
```
你好,你好吗?
```

### 示例2: 中文 → 英文
**选择文本:**
```
今天天气真好
```

**翻译结果:**
```
The weather is really nice today
```

### 示例3: 混合文本
**选择文本:**
```
我喜欢programming
```

**翻译结果:**
```
I like programming
```
(AI会根据主要语言判断翻译方向)

## 配置方法

### 1. 启用AI翻译
1. 打开设置页面(右键扩展图标 → 选项)
2. 选择"GPT 翻译"
3. 确认配置:
   - API密钥
   - AI模型
   - API地址
4. 保存设置

### 2. 自定义系统提示词(可选)

如果需要调整翻译行为,可以修改系统提示词:

**示例1: 更详细的指令**
```
你是一个专业的双向翻译助手。
- 检测到中文时,翻译成地道的英文
- 检测到英文时,翻译成简洁的中文
- 保持原文的语气和风格
只返回翻译结果。
```

**示例2: 专业领域翻译**
```
你是一个技术文档翻译专家。
- 中文→英文:使用准确的技术术语
- 英文→中文:保留英文专业术语,用括号标注中文解释
只返回翻译结果。
```

**示例3: 口语化翻译**
```
你是一个口语翻译助手。
- 中文→英文:翻译成日常口语英文
- 英文→中文:翻译成自然的中文口语
避免过于正式的表达。
```

## 测试双向翻译

### 快速测试步骤:

1. **测试英译中:**
   - 打开任意英文网页
   - 选择一段英文文本
   - 查看翻译结果(应该是中文)
   - 控制台显示: `[翻译助手] 使用引擎: AI翻译 (claude-sonnet-4-5)`

2. **测试中译英:**
   - 打开任意中文网页
   - 选择一段中文文本
   - 查看翻译结果(应该是英文)
   - 控制台显示: `[翻译助手] 使用引擎: AI翻译 (claude-sonnet-4-5)`

3. **查看翻译方向:**
   - 按F12打开开发者工具
   - 切换到Console标签
   - 查看原文和译文,确认翻译方向正确

## 注意事项

### ✅ 支持的功能
- 自动语言检测
- 中英双向翻译
- 保持原文语气
- 自定义翻译风格

### ⚠️ 限制
- Google翻译引擎暂不支持双向翻译
- 需要使用AI翻译引擎(GPT/Claude等)
- 混合语言文本可能需要更明确的提示词

### 💡 最佳实践
1. **使用AI翻译引擎**以获得最佳双向翻译效果
2. **测试不同场景**确保翻译方向正确
3. **根据需求调整系统提示词**
4. **查看控制台日志**了解翻译过程

## 故障排除

### 问题1: 翻译方向错误
**解决方法:**
- 检查系统提示词是否包含双向翻译指令
- 尝试更明确的提示词
- 查看控制台确认使用的是AI翻译引擎

### 问题2: 混合语言翻译不准确
**解决方法:**
- 在系统提示词中添加混合语言处理规则
- 例如: "如果文本包含多种语言,根据主要语言判断翻译方向"

### 问题3: Google翻译不支持双向
**解决方法:**
- 切换到AI翻译引擎
- Google翻译目前仅支持英译中

## 高级用法

### 多语言支持
可以扩展系统提示词支持更多语言:

```
你是一个多语言翻译助手。
- 中文 → 英文
- 英文 → 中文
- 日文 → 中文
- 韩文 → 中文
根据输入语言自动选择目标语言。
```

### 特定格式保留
```
你是一个翻译助手。
- 中文 → 英文
- 英文 → 中文
翻译时保留:
- Markdown格式
- 代码块
- 链接
只翻译文本内容。
```

---

**享受智能双向翻译的便利!** 🌐✨
